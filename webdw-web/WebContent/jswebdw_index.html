<!DOCTYPE html>
<meta http-equiv="Access-Control-Allow-Origin" content="*">
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script src="jswebdw2/jquery-3.3.1.js"></script>
<script src="jswebdw2/CWebDWUIView.js"></script>

<style>
.divcss5 {
	position: relative;
	width: 400px;
	height: 150px;
	overflow: auto;
	border: 1px solid #060
}
</style>

</head>
<body>
	<h2>Welcome to JSWebDW's world! Version2.0</h2>
	<h4>这个页面演示了使用WebDW进行单表增、删、查、改的具体功能。</h4>


	<input type="button" onclick="setDW()" value="设置数据窗口对象">
	请输入检索条件：
	<input type="text" name="p_name" id="p_name" size="10">
	<input type="button" onclick="retrieveDW()" value="检索产品清单(全文本框显示)">
	<input type="button" onclick="insertDW()" value="插入一条记录（空记录）">
	<input type="button" onclick="deleteDW()" value="删除一行记录">
	<input type="button" onclick="updateDW()" value="保存到数据库">
	<br>
	<div id="Picture1" name="Picture1"
		style="position: absolute; left: 10px; top: 160px; height: 360px; width: 1000px; overflow: auto">
		<div id="Picture2" name="Picture2"
			style="height: 250px; width: 1000px; overflow: auto"></div>
	</div>
	<script>
		var webdwui = new CWebDWUIView("Picture2");
		alert("webdwui:" + webdwui);
	</script>

	<script>
		//回调函数
		function WebdwUI_callback() {
			console.log("enter callback");
			var status = xmlHttpReturn.status;
			console.log("status:"+status);
			
			if(status == 200){
				webdwui.uuid = xmlHttpReturn.uuid;
				webdwui.uiArray = xmlHttpReturn.uiobjList;
				webdwui.removeAllChild();
				webdwui.drawAllChild();	
				alert(xmlHttpReturn.message);
			}else{
				console.log(xmlHttpReturn.message);
				alert("Message:" + xmlHttpReturn.message);
			}
			
		}
		
		//设置后台的数据窗口对象
		function setDW() {
			alert("setdw test");
			var dwname = "d_products"; //后台数据窗口的名字
			var iret2 = 0;
			iret2 = webdwui.setDataobject(dwname);
		}
		
		//设置后台的数据窗口对象
		function insertDW() {
			console.log("insert test");
			var uuid = webdwui.uuid; //后台数据窗口的名字
			var iret2 = 0;
			iret2 = webdwui.insert(uuid);
		}
		
		function deleteDW() {
			console.log("delete test");
			var uuid = webdwui.uuid; //后台数据窗口的名字
			var iret2 = 0;
			iret2 = webdwui.delete(uuid);
		}
		
		//setrow
		function setRow(rowid) {
			console.log("setrow test:"+rowid);
			var uuid = webdwui.uuid; //后台数据窗口的名字
			var iret2 = 0;
			iret2 = webdwui.setrow(uuid,rowid);
		}
		
		//setdata
		function setData(rowid,colid,value) {
			console.log("setdata test:"+value);
			var uuid = webdwui.uuid; //后台数据窗口的名字
			var iret2 = 0;
			iret2 = webdwui.setdata(uuid,rowid,colid,value);
		}
		
		function updateDW() {
			alert("update test:");
			var uuid = webdwui.uuid; //后台数据窗口的名字
			var iret2 = 0;
			iret2 = webdwui.update(uuid);
		}
		
		//检索数据，由于后台是无状态的，因此需要重新传入数据窗口的名称进行检索
		function retrieveDW() {
			alert("retrieve test");
			var dwname = "d_products";
			var iret3 = 0;
			var args = "name=" + $("#p_name").val();
			alert(args);
			iret3 = webdwui.retrieve(dwname,args);
		}
		
	</script>

</body>
</html>